{"version":3,"sources":["webpack:///webpack/bootstrap 12ba293ca1bd43ec5b2b","webpack:///./inc/js/tinymce-entrypoint.ts","webpack:///./inc/js/utils/Dispatcher.js","webpack:///./inc/js/utils/Parsers.js"],"names":[],"mappings":"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C,IAAI,CAAC,WAAW,EAAE,SAAS,EAAE,YAAY,CAAC,CAAC;KAC7D,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,cAAc,EAAE,kBAAkB,EAAE,YAAY,CAAC,CAAC;KAEjF,MAAM,CAAC,SAAS,CAAC,eAAe,EAAE,UAAU,CAAC,CAAC;AAIhD,EAAC,CAAC,CAAC;;;;;;;AC5NH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB;AACpB,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAA+D,iCAAiC,EAAE;AAClG;AACA;AACA;AACA;AACA,EAAC;AACD,+CAA8C,cAAc;AAC5D;;;;;;;ACvIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iGAAgG;AAChG;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA2D,oBAAoB,EAAE;AACjF;AACA;AACA,gCAA+B,OAAO;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0FAAyF;AACzF;AACA;AACA;AACA;AACA;AACA;AACA,6FAA4F,iCAAiC;AAC7H;AACA,mFAAkF,iDAAiD;AACnI;AACA;AACA,uFAAsF,iDAAiD;AACvI,+EAA8E,iDAAiD;AAC/H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mGAAkG;AAClG;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA,gCAA+B,OAAO;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wDAAuD,gCAAgC;AACvF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD","file":"tinymce-entrypoint.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 12ba293ca1bd43ec5b2b\n **/","\n/// <reference path=\"./utils/HelperFunctions.ts\"/>\nimport Dispatcher from './utils/Dispatcher';\n\ndeclare var tinymce, tinyMCE, ABT_locationInfo\n\n\ntinymce.PluginManager.add('abt_main_menu', (editor, url: string) => {\n\n  //==================================================\n  //                 MAIN BUTTON\n  //==================================================\n\n  let ABT_Button: TinyMCEPluginButton = {\n    type: 'menubutton',\n    image: url + '/../images/book.png',\n    title: 'Academic Blogger\\'s Toolkit',\n    icon: true,\n    menu: [],\n  };\n\n  //==================================================\n  //               BUTTON FUNCTIONS\n  //==================================================\n\n  let openInlineCitationWindow = () => {\n    editor.windowManager.open(<TinyMCEWindowMangerObject>{\n      title: 'Inline Citation',\n      url: ABT_locationInfo.tinymceViewsURL + 'inline-citation.html',\n      width: 400,\n      height: 85,\n      onClose: (e) => {\n        if (!e.target.params.data) { return; }\n        editor.insertContent(\n          '[cite num=&quot;' + e.target.params.data + '&quot;]'\n        );\n      }\n    });\n  }\n\n  let openFormattedReferenceWindow = () => {\n    editor.windowManager.open(<TinyMCEWindowMangerObject>{\n      title: 'Insert Formatted Reference',\n      url: ABT_locationInfo.tinymceViewsURL + 'formatted-reference.html',\n      width: 600,\n      height: 100,\n      onclose: (e: any) => {\n\n        // If the user presses the exit button, return.\n        if (Object.keys(e.target.params).length === 0) {\n          return;\n        }\n        editor.setProgressState(1);\n        let payload: ReferenceFormData = e.target.params.data;\n        let refparser = new Dispatcher(payload, editor);\n\n        if (payload.hasOwnProperty('manual-type-selection')) {\n          refparser.fromManualInput(payload);\n          editor.setProgressState(0);\n          return;\n        }\n\n        // do pmid parsing\n        refparser.fromPMID();\n\n      },\n    });\n  };\n\n  let generateSmartBib = function() {\n    console.log(this)\n    let dom: HTMLDocument = editor.dom.doc;\n    let existingSmartBib: HTMLOListElement = <HTMLOListElement>dom.getElementById('abt-smart-bib');\n\n    if (!existingSmartBib) {\n      let smartBib: HTMLOListElement = <HTMLOListElement>dom.createElement('OL');\n      let horizontalRule: HTMLHRElement = <HTMLHRElement>dom.createElement('HR');\n      smartBib.id = 'abt-smart-bib';\n      horizontalRule.className = 'abt_editor-only';\n      let comment = dom.createComment(`Smart Bibliography Generated By Academic Blogger's Toolkit`);\n      dom.body.appendChild(comment);\n      dom.body.appendChild(horizontalRule);\n      dom.body.appendChild(smartBib);\n      this.state.set('disabled', true);\n    }\n\n    return;\n  }\n\n\n\n\n  //==================================================\n  //                 MENU ITEMS\n  //==================================================\n\n  let separator: TinyMCEMenuItem = { text: '-' };\n\n\n  let bibToolsMenu: TinyMCEMenuItem = {\n    text: 'Other Tools',\n    menu: [],\n  };\n\n\n  let inlineCitation: TinyMCEMenuItem = {\n    text: 'Inline Citation',\n    onclick: openInlineCitationWindow,\n  }\n  editor.addShortcut('meta+alt+c', 'Insert Inline Citation', openInlineCitationWindow);\n\n\n  let formattedReference: TinyMCEMenuItem = {\n    text: 'Formatted Reference',\n    onclick: openFormattedReferenceWindow,\n  }\n  editor.addShortcut('meta+alt+r', 'Insert Formatted Reference', openFormattedReferenceWindow);\n\n\n  let smartBib: TinyMCEMenuItem = {\n    text: 'Generate Smart Bibliography',\n    id: 'smartbib',\n    onclick: generateSmartBib,\n    disabled: false,\n  }\n\n\n  let trackedLink: TinyMCEMenuItem = {\n    text: 'Tracked Link',\n    onclick: () => {\n\n      let user_selection = tinyMCE.activeEditor.selection.getContent({format: 'text'});\n\n      /** TODO: Fix this so it doesn't suck */\n      editor.windowManager.open({\n        title: 'Insert Tracked Link',\n        width: 600,\n        height: 160,\n        buttons: [{\n          text: 'Insert',\n          onclick: 'submit'\n        }],\n        body: [\n          {\n            type: 'textbox',\n            name: 'tracked_url',\n            label: 'URL',\n            value: ''\n          },\n          {\n            type: 'textbox',\n            name: 'tracked_title',\n            label: 'Link Text',\n            value: user_selection\n          },\n          {\n            type: 'textbox',\n            name: 'tracked_tag',\n            label: 'Custom Tag ID',\n            tooltip: 'Don\\'t forget to create matching tag in Google Tag Manager!',\n            value: ''\n          },\n          {\n            type: 'checkbox',\n            name: 'tracked_new_window',\n            label: 'Open link in a new window/tab'\n          },\n        ],\n        onsubmit: (e) => {\n          let trackedUrl = e.data.tracked_url;\n          let trackedTitle = e.data.tracked_title;\n          let trackedTag = e.data.tracked_tag;\n          let trackedLink = `<a href=\"${trackedUrl}\" id=\"${trackedTag}\" ` +\n            `${e.data.tracked_new_window ? 'target=\"_blank\"' : ''}>${trackedTitle}</a>`;\n\n          editor.execCommand('mceInsertContent', false, trackedLink);\n\n        }\n      });\n    }\n  }\n  // End Tracked Link Menu Item\n\n  let requestTools: TinyMCEMenuItem = {\n    text: 'Request More Tools',\n    onclick: () => {\n      editor.windowManager.open({\n        title: 'Request More Tools',\n        body: [{\n          type: 'container',\n          html:\n            `<div style=\"text-align: center;\">` +\n              `Have a feature or tool in mind that isn't available?<br>` +\n              `<a ` +\n              `href=\"https://github.com/dsifford/academic-bloggers-toolkit/issues\" ` +\n              `style=\"color: #00a0d2;\" ` +\n              `target=\"_blank\">Open an issue</a> on the GitHub repository and let me know!` +\n            `</div>`,\n        }],\n        buttons: [],\n      });\n    }\n  }\n\n  setTimeout(() => {\n    let dom: HTMLDocument = editor.dom.doc;\n    let existingSmartBib: HTMLOListElement = <HTMLOListElement>dom.getElementById('abt-smart-bib');\n    if (existingSmartBib) {\n      smartBib.disabled = true;\n      smartBib.text = 'Smart Bibliography Generated!';\n    }\n  }, 500);\n\n  bibToolsMenu.menu.push(trackedLink, separator, requestTools);\n  ABT_Button.menu.push(smartBib, inlineCitation, formattedReference, bibToolsMenu);\n\n  editor.addButton('abt_main_menu', ABT_Button);\n\n\n\n});\n\n\n\n/** WEBPACK FOOTER **\n ** ./inc/js/tinymce-entrypoint.ts\n **/","\"use strict\";\r\nvar Parsers_1 = require('./Parsers');\r\nvar Dispatcher = (function () {\r\n    function Dispatcher(data, editor) {\r\n        this.citationFormat = data['citation-format'];\r\n        this.PMIDquery = data['pmid-input'] !== '' && data['pmid-input'] !== undefined\r\n            ? data['pmid-input'].replace(/\\s/g, '')\r\n            : '';\r\n        this.manualCitationType = data['manual-type-selection'];\r\n        this.includeLink = data['include-link'];\r\n        this.editor = editor;\r\n        var smartBib = this.editor.dom.doc\r\n            .getElementById('abt-smart-bib');\r\n        this.smartBib = smartBib || false;\r\n    }\r\n    Dispatcher.prototype.fromPMID = function () {\r\n        var requestURL = \"http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=pubmed&id=\" + this.PMIDquery + \"&version=2.0&retmode=json\";\r\n        var request = new XMLHttpRequest();\r\n        request.open('GET', requestURL, true);\r\n        request.addEventListener('load', this._parsePMID.bind(this));\r\n        request.send(null);\r\n    };\r\n    Dispatcher.prototype.fromManualInput = function (data) {\r\n        var cleanedData;\r\n        var type = this.manualCitationType;\r\n        var authors = data.authors.map(function (author) {\r\n            var name = author.name.split(' ')[1] + \" \" + author.name.split(' ')[0][0];\r\n            return { name: name };\r\n        });\r\n        var title = data[(type + \"-title\")].toTitleCase();\r\n        var source = data[(type + \"-source\")];\r\n        var pubdate = data[(type + \"-date\")] || '';\r\n        var volume = data[(type + \"-volume\")] || '';\r\n        var issue = data[(type + \"-issue\")] || '';\r\n        var pages = data[(type + \"-pages\")] || '';\r\n        var lastauthor = data.authors.length > 0\r\n            ? data.authors[data.authors.length - 1].name\r\n            : '';\r\n        var url = data[(type + \"-url\")] || '';\r\n        var accessdate = data[(type + \"-accessed\")] || '';\r\n        var updated = data[(type + \"-updated\")] || '';\r\n        var location = data[(type + \"-location\")] || '';\r\n        var chapter = data[(type + \"-chapter\")] || '';\r\n        var edition = data[(type + \"-edition\")] || '';\r\n        cleanedData = {\r\n            authors: authors,\r\n            title: title,\r\n            source: source,\r\n            pubdate: pubdate,\r\n            volume: volume,\r\n            issue: issue,\r\n            pages: pages,\r\n            lastauthor: lastauthor,\r\n            url: url,\r\n            accessdate: accessdate,\r\n            updated: updated,\r\n            location: location,\r\n            chapter: chapter,\r\n            edition: edition,\r\n        };\r\n        var payload;\r\n        switch (this.citationFormat) {\r\n            case 'ama':\r\n                var ama = new Parsers_1.AMA(this.includeLink, this.manualCitationType);\r\n                payload = ama.parse([cleanedData]);\r\n                break;\r\n            case 'apa':\r\n                var apa = new Parsers_1.APA(this.includeLink, this.manualCitationType);\r\n                ;\r\n                payload = apa.parse([cleanedData]);\r\n                break;\r\n            default:\r\n                this.editor.windowManager.alert('An error occurred while trying to parse the citation');\r\n                this.editor.setProgressState(0);\r\n                return;\r\n        }\r\n        this._deliverContent(payload);\r\n    };\r\n    Dispatcher.prototype._parsePMID = function (e) {\r\n        var req = e.target;\r\n        if (req.readyState !== 4 || req.status !== 200) {\r\n            this.editor.windowManager.alert('Your request could not be processed. Please try again.');\r\n            this.editor.setProgressState(0);\r\n            return;\r\n        }\r\n        var res = JSON.parse(req.responseText);\r\n        if (res.error) {\r\n            var badPMID = res.error.match(/uid (\\S+)/)[1];\r\n            var badIndex = this.PMIDquery.split(',').indexOf(badPMID);\r\n            this.editor.windowManager.alert(\"PMID \\\"\" + badPMID + \"\\\" at index #\" + (badIndex + 1) + \" failed to process. Double check your list!\");\r\n        }\r\n        var payload;\r\n        switch (this.citationFormat) {\r\n            case 'ama':\r\n                var ama = new Parsers_1.AMA(this.includeLink, this.citationFormat);\r\n                payload = ama.parse(res.result);\r\n                break;\r\n            case 'apa':\r\n                var apa = new Parsers_1.APA(this.includeLink, this.citationFormat);\r\n                payload = apa.parse(res.result);\r\n                break;\r\n            default:\r\n                this.editor.windowManager.alert('An error occurred while trying to parse the citation');\r\n                this.editor.setProgressState(0);\r\n                return;\r\n        }\r\n        this._deliverContent(payload);\r\n    };\r\n    Dispatcher.prototype._deliverContent = function (payload) {\r\n        if (payload.name === 'Error') {\r\n            this.editor.windowManager.alert(payload.message);\r\n            this.editor.setProgressState(0);\r\n            return;\r\n        }\r\n        if (this.smartBib) {\r\n            for (var key in payload) {\r\n                var listItem = this.editor.dom.doc.createElement('LI');\r\n                listItem.innerHTML = payload[key];\r\n                this.smartBib.appendChild(listItem);\r\n            }\r\n            this.editor.setProgressState(0);\r\n            return;\r\n        }\r\n        if (payload.length === 1) {\r\n            this.editor.insertContent(payload.join());\r\n            this.editor.setProgressState(0);\r\n            return;\r\n        }\r\n        var orderedList = '<ol>' + payload.map(function (ref) { return (\"<li>\" + ref + \"</li>\"); }).join('') + '</ol>';\r\n        this.editor.insertContent(orderedList);\r\n        this.editor.setProgressState(0);\r\n    };\r\n    return Dispatcher;\r\n}());\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.default = Dispatcher;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./inc/js/utils/Dispatcher.js\n ** module id = 1\n ** module chunks = 0\n **/","\"use strict\";\r\nvar AMA = (function () {\r\n    function AMA(includeLink, manualCitationType) {\r\n        this._isManual = true;\r\n        this.includeLink = includeLink;\r\n        this.manualCitationType = manualCitationType;\r\n    }\r\n    AMA.prototype.parse = function (data) {\r\n        var pmidArray = data.uids || false;\r\n        if (pmidArray) {\r\n            this._isManual = false;\r\n            return this._fromPMID(data, pmidArray);\r\n        }\r\n        return [this._fromManual(data)];\r\n    };\r\n    AMA.prototype._fromPMID = function (data, pmidArray) {\r\n        var _this = this;\r\n        var output;\r\n        try {\r\n            output = pmidArray.map(function (PMID) {\r\n                var ref = data[PMID];\r\n                var year = ref.pubdate.substr(0, 4);\r\n                var link = _this.includeLink === true\r\n                    ? \" PMID: <a href=\\\"http://www.ncbi.nlm.nih.gov/pubmed/\" + PMID + \"\\\" target=\\\"_blank\\\">\" + PMID + \"</a>\"\r\n                    : '';\r\n                var authors = _this._parseAuthors(ref.authors);\r\n                if (authors.name === 'Error') {\r\n                    throw authors;\r\n                }\r\n                return (authors + \" \" + ref.title + \" <em>\" + ref.source + \".</em> \" + year + \"; \") +\r\n                    (\"\" + (ref.volume === undefined || ref.volume === '' ? '' : ref.volume)) +\r\n                    ((ref.issue === undefined || ref.issue === '' ? '' : '(' + ref.issue + ')') + \":\") +\r\n                    (ref.pages + \".\" + link);\r\n            });\r\n        }\r\n        catch (e) {\r\n            return e;\r\n        }\r\n        return output;\r\n    };\r\n    AMA.prototype._fromManual = function (data) {\r\n        var payload;\r\n        switch (this.manualCitationType) {\r\n            case 'journal':\r\n                payload = this._parseJournal(data);\r\n                break;\r\n            case 'website':\r\n                payload = this._parseWebsite(data);\r\n                break;\r\n            case 'book':\r\n                payload = this._parseBook(data);\r\n                break;\r\n        }\r\n        return payload;\r\n    };\r\n    AMA.prototype._parseAuthors = function (authorArr) {\r\n        var authors = '';\r\n        switch (authorArr.length) {\r\n            case 0:\r\n                if (this._isManual === true) {\r\n                    break;\r\n                }\r\n                return new Error(\"No authors were found for given reference\");\r\n            case 1:\r\n            case 2:\r\n            case 3:\r\n            case 4:\r\n            case 5:\r\n            case 6:\r\n                authors = authorArr.map(function (author) { return author.name; }).join(', ') + '.';\r\n                break;\r\n            default:\r\n                for (var i = 0; i < 3; i++) {\r\n                    authors += authorArr[i].name + ', ';\r\n                }\r\n                ;\r\n                authors += 'et al.';\r\n        }\r\n        return authors;\r\n    };\r\n    AMA.prototype._parseJournal = function (data) {\r\n        var authors = this._parseAuthors(data[0].authors);\r\n        var year = (new Date(data[0].pubdate).getFullYear() + 1).toString();\r\n        var source = data[0].source.toTitleCase();\r\n        var issue = \"(\" + data[0].issue + \")\" || '';\r\n        var volume = data[0].volume || '';\r\n        return (authors + \" \" + data[0].title + \". <em>\" + source + \".</em> \" + year + \"; \") +\r\n            (\"\" + volume + issue + \":\" + data[0].pages + \".\");\r\n    };\r\n    AMA.prototype._parseWebsite = function (data) {\r\n        var authors = data[0].authors.length > 0\r\n            ? this._parseAuthors(data[0].authors) + ' '\r\n            : '';\r\n        var pubdate = \"Published \" + new Date(data[0].pubdate).toLocaleDateString('en-us', { month: 'long', year: 'numeric' }) + \". \";\r\n        var updated = data[0].updated !== ''\r\n            ? \"Updated \" + new Date(data[0].updated).toLocaleDateString('en-us', { month: 'long', day: 'numeric', year: 'numeric' }) + \". \"\r\n            : '';\r\n        var accessed = data[0].accessdate !== ''\r\n            ? \"Accessed \" + new Date(data[0].accessdate).toLocaleDateString('en-us', { month: 'long', day: 'numeric', year: 'numeric' }) + \". \"\r\n            : \"Accessed \" + new Date(Date.now()).toLocaleDateString('en-us', { month: 'long', day: 'numeric', year: 'numeric' });\r\n        return (\"\" + authors + data[0].title + \". <em>\" + data[0].source + \"</em>. Available at: \") +\r\n            (\"<a href=\\\"\" + data[0].url + \"\\\" target=\\\"_blank\\\">\" + data[0].url + \"</a>. \" + pubdate + updated + accessed);\r\n    };\r\n    AMA.prototype._parseBook = function (data) {\r\n        console.log(data);\r\n        var authors = this._parseAuthors(data[0].authors);\r\n        var title = data[0].title;\r\n        var pubLocation = data[0].location !== ''\r\n            ? data[0].location + \":\"\r\n            : \"\";\r\n        var publisher = data[0].source;\r\n        var year = data[0].pubdate;\r\n        var chapter = data[0].chapter !== ''\r\n            ? \" \" + data[0].chapter + \". In:\"\r\n            : \"\";\r\n        var pages = data[0].pages !== ''\r\n            ? \": \" + data[0].pages + \".\"\r\n            : \".\";\r\n        return \"\" + authors + chapter + \" <em>\" + title + \"</em>. \" + pubLocation + publisher + \"; \" + year + pages;\r\n    };\r\n    return AMA;\r\n}());\r\nexports.AMA = AMA;\r\nvar APA = (function () {\r\n    function APA(includeLink, manualCitationType) {\r\n        this._isManual = true;\r\n        this.includeLink = includeLink;\r\n        this.manualCitationType = manualCitationType;\r\n    }\r\n    APA.prototype.parse = function (data) {\r\n        var pmidArray = data.uids || false;\r\n        if (pmidArray) {\r\n            this._isManual = false;\r\n            return this._fromPMID(data, pmidArray);\r\n        }\r\n        return [this._fromManual(data)];\r\n    };\r\n    APA.prototype._fromPMID = function (data, pmidArray) {\r\n        var _this = this;\r\n        var output;\r\n        try {\r\n            output = pmidArray.map(function (PMID) {\r\n                var ref = data[PMID];\r\n                var year = ref.pubdate.substr(0, 4);\r\n                var link = _this.includeLink === true\r\n                    ? \" PMID: <a href=\\\"http://www.ncbi.nlm.nih.gov/pubmed/\" + PMID + \"\\\" target=\\\"_blank\\\">\" + PMID + \"</a>\"\r\n                    : '';\r\n                var authors = _this._parseAuthors(ref.authors, ref.lastauthor);\r\n                if (authors.name === 'Error') {\r\n                    throw authors;\r\n                }\r\n                return (authors + \" (\" + year + \"). \" + ref.title + \" <em>\") +\r\n                    ((ref.fulljournalname === undefined || ref.fulljournalname === '' ? ref.source : ref.fulljournalname.toTitleCase()) + \".</em>, \") +\r\n                    (\"\" + (ref.volume === undefined || ref.volume === '' ? '' : ref.volume)) +\r\n                    ((ref.issue === undefined || ref.issue === '' ? '' : '(' + ref.issue + ')') + \", \") +\r\n                    (ref.pages + \".\" + link);\r\n            });\r\n        }\r\n        catch (e) {\r\n            return e;\r\n        }\r\n        return output;\r\n    };\r\n    APA.prototype._fromManual = function (data) {\r\n        var payload;\r\n        switch (this.manualCitationType) {\r\n            case 'journal':\r\n                payload = this._parseJournal(data);\r\n                break;\r\n            case 'website':\r\n                payload = this._parseWebsite(data);\r\n                break;\r\n            case 'book':\r\n                payload = this._parseBook(data);\r\n                break;\r\n        }\r\n        return payload;\r\n    };\r\n    APA.prototype._parseAuthors = function (authorArr, lastAuthor) {\r\n        var authors = '';\r\n        switch (authorArr.length) {\r\n            case 0:\r\n                if (this._isManual === true) {\r\n                    break;\r\n                }\r\n                return new Error(\"No authors were found for given reference\");\r\n            case 1:\r\n                authors = authorArr.map(function (author) {\r\n                    return (author.name.split(' ')[0] + \", \") +\r\n                        (author.name.split(' ')[1].split('').join('. ') + \".\");\r\n                }).join();\r\n                break;\r\n            case 2:\r\n                authors = authorArr.map(function (author) {\r\n                    return (author.name.split(' ')[0] + \", \") +\r\n                        (author.name.split(' ')[1].split('').join('. ') + \".\");\r\n                }).join(', & ');\r\n                break;\r\n            case 3:\r\n            case 4:\r\n            case 5:\r\n            case 6:\r\n            case 7:\r\n                authors = authorArr.map(function (author, i, arr) {\r\n                    if (i === arr.length - 1) {\r\n                        return ((\"& \" + author.name.split(' ')[0] + \", \") +\r\n                            (author.name.split(' ')[1].split('').join('. ') + \".\"));\r\n                    }\r\n                    return ((author.name.split(' ')[0] + \", \") +\r\n                        (author.name.split(' ')[1].split('').join('. ') + \"., \"));\r\n                }).join('');\r\n                break;\r\n            default:\r\n                for (var i = 0; i < 6; i++) {\r\n                    authors +=\r\n                        (authorArr[i].name.split(' ')[0] + \", \") +\r\n                            (authorArr[i].name.split(' ')[1].split('').join('. ') + \"., \");\r\n                }\r\n                authors += \". . . \" +\r\n                    (lastAuthor.split(' ')[0] + \", \") +\r\n                    (lastAuthor.split(' ')[1].split('').join('. ') + \".\");\r\n                break;\r\n        }\r\n        return authors;\r\n    };\r\n    APA.prototype._parseJournal = function (data) {\r\n        var authors = this._parseAuthors(data[0].authors, data[0].lastauthor);\r\n        var year = (new Date(data[0].pubdate).getFullYear() + 1).toString();\r\n        var source = data[0].source.toTitleCase();\r\n        var issue = \"(\" + data[0].issue + \")\" || '';\r\n        var volume = data[0].volume || '';\r\n        return (authors + \" (\" + year + \"). \" + data[0].title + \". <em>\") +\r\n            (source + \".</em>, \" + volume + issue + \", \" + data[0].pages + \".\");\r\n    };\r\n    APA.prototype._parseWebsite = function (data) {\r\n        var authors = this._parseAuthors(data[0].authors, data[0].lastauthor);\r\n        var rawDate = new Date(data[0].pubdate);\r\n        var source = data[0].source.toTitleCase();\r\n        var date = (rawDate.getFullYear() + \", \") +\r\n            (\"\" + rawDate.toLocaleDateString('en-us', { month: 'long', day: 'numeric' }));\r\n        return (authors + \" (\" + date + \"). \" + data[0].title + \". <em>\" + source + \"</em>. \") +\r\n            (\"Retrieved from <a href=\\\"\" + data[0].url + \"\\\" target=\\\"_blank\\\">\" + data[0].url + \"</a>\");\r\n    };\r\n    APA.prototype._parseBook = function (data) {\r\n        var authors = this._parseAuthors(data[0].authors, data[0].lastauthor);\r\n        var year = (new Date(data[0].pubdate).getFullYear() + 1).toString();\r\n        var pubLocation = data[0].location !== ''\r\n            ? data[0].location + \":\"\r\n            : '';\r\n        var publisher = data[0].source;\r\n        var chapter = data[0].chapter !== ''\r\n            ? \" \" + data[0].chapter + \". In\"\r\n            : '';\r\n        var pages = data[0].pages !== ''\r\n            ? \" (\" + data[0].pages + \")\"\r\n            : '';\r\n        return (authors + \" (\" + year + \").\" + chapter + \" <em>\" + data[0].title + \"</em>\" + pages + \". \") +\r\n            (\"\" + pubLocation + publisher + \".\");\r\n    };\r\n    return APA;\r\n}());\r\nexports.APA = APA;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./inc/js/utils/Parsers.js\n ** module id = 2\n ** module chunks = 0\n **/"],"sourceRoot":""}